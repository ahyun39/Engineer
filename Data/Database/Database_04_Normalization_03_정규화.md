## 정규화

<br>

### 정규화 (Normalization)

- 이상 현상을 제거하면서 데이터베이스 구조를 올바르게 설계해 나가는 과정
    
    → 함수적 종속 관계에 있는 속성들을 분리
    
- 단, 정규화를 통해 얻은 Relation은 무손실 분해(non-loss decomposition)이어야 함
    - Relation은 의미적으로 동등한 Relation들로 분해되어야 하고 분해로 인한 정보의 손실이 발생하지 않아야 함
    - 분해된 Relation들을 자연 조인하면 분해 전의 Relation으로 복원 가능해야 함

<br>
<br>

### 정규형 (Normal Form)

- Relation이 정규화 된 정도

- 각 정규형마다 제약조건이 존재

- 정규형의 차수가 높아질수록 요구되는 제약조건이 많아지고 엄격해짐

- Relation의 특성을 고려하여 적합한 정규형을 선택

<br>
<br>

### 제1정규형 (First Normal Formm; 1NF)

- Relation의 모든 속성이 더는 분해되지 않는 원자 값(atomic value)만 가지만 제1정규형을 만족함

- 제1정규형을 만족해야 관계 데이터베이스의 Relation이 될 자격이 있음

- 제1정규형을 만족해도, 이상 현상 발생 가능
    - 데이터 불일치로 인한 갱신 이상
    - 데이터 손실로 인한 삭제 이상
    - 삽입 불가로 인한 삽입 이상

- 제1정규형에서 이상 현상의 발생 이유
    - Primary Key의 일부분인 ‘고객아이디’ 속성에 부분 종속되는 ‘등급’과 ‘할인율’ 속성이 존재하기 때문

- 문제 해결 방법
    - 부분 함수 종속이 제거되도록 이벤트참여 Relation을 분해
        
        → 분해된 Relation은 제2정규형에 속하게 됨
        
<br>
<br>

### 제2정규형 (Second Normal Form; 2NF)

- Relation이 제1정규형에 속하고, PK가 아닌 모든 속성이 PK에 완전 함수 종속되면 제2정규형을 만족함

- 제2정규형은 만족하지만, 여전히 이상 현상 발생 가능
    - 등급에 따라 할인율이 결정되는 상황
    - 이행적 함수 종속이 존재하기 때문
        
<br>
<br>

### 이행적 함수 종속 (Transitive Functional Dependency)

- Relation을 구성하는 세 개의 속성 집합 X, Y, Z에 대해

- 함수 종속 관계 X → Y와 Y → Z가 존재하면

- 논리적으로 X → Z가 성립되는데, 이것을 Z가 X에 이행적으로 함수 종속되었다고 함
        
<br>
<br>

### 제3정규형

- Relation이 제2정규형에 속하고, PK가 아닌 모든 속성이 PK에 이행적 함수 종속되지 않으면 제3정규형을 만족함

- 제3정규형은 만족하지만, 여전히 이상 현상 발생
    - 예 ) 강사당 한 강좌만 개설하는 상황
        
<br>
<br>

### 보이스/코드 정규형 (Boyce/Codd Normal Form; BCNF)

- 강한 제3정규형 (String 3NF)

- 후보키를 여러 개 가지고 있는 Relation에 발생할 수 있는 이상 현상을 해결하기 위해 제3정규형보다 좀 더 엄격한 제약조건을 제기

- 보이스/코드 정규형에 속하는 모든 Relatioin은 제3정규형에 속하지만, 제3정규형에 속하는 모든 Relation이 보이스/코드 정규형에 속하는 것은 아님
        
<br>
<br>

### 제4정규형 (Forth Normal Form; 4NF)

- Relation이 보이스/코드 정규형을 만족하면서, 함수 종속이 아닌 다치 종속(MVD; MultiValued Dependency)를 제거하면 제4정규형

- 다치 종속 : X, Y, Z 세개의 속성을 가진 Relation에서 (X, Z)에 대응되는 Y가 X에만 종속되고 Z에는 독립
        
<br>
<br>

### 제5정규형 (Fifth Normal Form; 5NF)

- 제5정규형 : 이 제4정규형을 만족하면서, Candidate Key를 통해서만 조인 종속이 만족되는 Relation
    - 조인 종속 : 한 Relation을 여러 Relation으로 분해했을 때, 분해된 Relation들로 자연 조인을 하면 원래 Relatioin을 만들 수 있는 상태
        
<br>
<br>

### 정규화 과정 정리

**비정규형 릴레이션**

↓ 속성의 도메인이 원자 값으로만 구성되도록 분해

**제1정규형 릴레이션**

(모든 속성의 도메인이 원자 값으로만 구성)

↓ 부분 함수 종속 제거

**제2정규형 릴레이션**

(모든 속성이 기본키에 완전 함수 종속)

↓ 이행적 함수 종속 제거

**제3정규형 릴레이션**

(모든 속성이 기본키에 이행적 함수 종속이 아님)

↓ 후보키가 아닌 결정자 제거

**보이스/코드 정규형 릴레이션**

(모든 결정자가 후보키)
        
<br>
<br>

### 정규화 시 주의 사항

- 모든 Relation이 제5정규형에 속해야만 바람직한 것은 아님

- 일반적으로 제3정규형이나 보이스/코드 정규형에 속하도록 Relation을 분해하여 데이터 중복을 줄이고 이상 현상을 해결하는 경우가 많음